name: Build and Deploy Documentation Site

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Generate VitePress Configuration
        run: |
          # Create directories
          mkdir -p .vitepress
          mkdir -p public

          # Generate package.json
          cat > package.json << 'PKGJSON'
          {
            "name": "system-design-patterns-docs",
            "private": true,
            "type": "module",
            "scripts": {
              "docs:dev": "vitepress dev",
              "docs:build": "vitepress build",
              "docs:preview": "vitepress preview"
            },
            "devDependencies": {
              "vitepress": "^1.5.0"
            }
          }
          PKGJSON

          # Generate VitePress config with i18n
          cat > .vitepress/config.mts << 'VITECONFIG'
          import { defineConfig } from 'vitepress'

          // Shared sidebar configuration
          const sidebarEN = [
            {
              text: '1. Foundations',
              collapsed: false,
              items: [
                { text: 'ACID Transactions', link: '/01-foundations/01-acid-transactions' },
                { text: 'Isolation Levels', link: '/01-foundations/02-isolation-levels' },
                { text: 'CAP Theorem', link: '/01-foundations/03-cap-theorem' },
                { text: 'Consistency Models', link: '/01-foundations/04-consistency-models' },
                { text: 'Distributed Time', link: '/01-foundations/05-distributed-time' },
                { text: 'Failure Modes', link: '/01-foundations/06-failure-modes' },
                { text: 'Network Partitions', link: '/01-foundations/07-network-partitions' },
                { text: 'Idempotency', link: '/01-foundations/08-idempotency' },
              ]
            },
            {
              text: '2. Distributed Databases',
              collapsed: true,
              items: [
                { text: 'Single-Leader Replication', link: '/02-distributed-databases/01-single-leader-replication' },
                { text: 'Multi-Leader Replication', link: '/02-distributed-databases/02-multi-leader-replication' },
                { text: 'Leaderless Replication', link: '/02-distributed-databases/03-leaderless-replication' },
                { text: 'Conflict Resolution', link: '/02-distributed-databases/04-conflict-resolution' },
                { text: 'Partitioning Strategies', link: '/02-distributed-databases/05-partitioning-strategies' },
                { text: 'Secondary Indexes', link: '/02-distributed-databases/06-secondary-indexes' },
                { text: 'Distributed Transactions', link: '/02-distributed-databases/07-distributed-transactions' },
                { text: 'Consensus Algorithms', link: '/02-distributed-databases/08-consensus-algorithms' },
                { text: 'Leader Election', link: '/02-distributed-databases/09-leader-election' },
              ]
            },
            {
              text: '3. Storage Engines',
              collapsed: true,
              items: [
                { text: 'B-Trees', link: '/03-storage-engines/01-b-trees' },
                { text: 'LSM Trees', link: '/03-storage-engines/02-lsm-trees' },
                { text: 'SSTables & Compaction', link: '/03-storage-engines/03-sstables-compaction' },
                { text: 'Write-Ahead Logging', link: '/03-storage-engines/04-write-ahead-logging' },
                { text: 'Bloom Filters', link: '/03-storage-engines/05-bloom-filters' },
                { text: 'Column Storage', link: '/03-storage-engines/06-column-storage' },
                { text: 'Data Encoding', link: '/03-storage-engines/07-data-encoding' },
              ]
            },
            {
              text: '4. Caching',
              collapsed: true,
              items: [
                { text: 'Cache Strategies', link: '/04-caching/01-cache-strategies' },
                { text: 'Cache Invalidation', link: '/04-caching/02-cache-invalidation' },
                { text: 'Distributed Caching', link: '/04-caching/03-distributed-caching' },
                { text: 'Cache Stampede', link: '/04-caching/04-cache-stampede' },
                { text: 'Multi-Tier Caching', link: '/04-caching/05-multi-tier-caching' },
                { text: 'Cache Warming', link: '/04-caching/06-cache-warming' },
              ]
            },
            {
              text: '5. Messaging',
              collapsed: true,
              items: [
                { text: 'Message Queues', link: '/05-messaging/01-message-queues' },
                { text: 'Pub/Sub Systems', link: '/05-messaging/02-pub-sub' },
                { text: 'Message Ordering', link: '/05-messaging/03-message-ordering' },
                { text: 'Delivery Guarantees', link: '/05-messaging/04-delivery-guarantees' },
                { text: 'Event Sourcing', link: '/05-messaging/05-event-sourcing' },
                { text: 'CQRS', link: '/05-messaging/06-cqrs' },
                { text: 'Outbox Pattern', link: '/05-messaging/07-outbox-pattern' },
                { text: 'Dead Letter Queues', link: '/05-messaging/08-dead-letter-queues' },
              ]
            },
            {
              text: '6. Scaling',
              collapsed: true,
              items: [
                { text: 'Load Balancing', link: '/06-scaling/01-load-balancing' },
                { text: 'Horizontal vs Vertical', link: '/06-scaling/02-horizontal-vertical' },
                { text: 'Database Sharding', link: '/06-scaling/03-database-sharding' },
                { text: 'CDN Architecture', link: '/06-scaling/04-cdn-architecture' },
                { text: 'Rate Limiting', link: '/06-scaling/05-rate-limiting' },
                { text: 'Circuit Breakers', link: '/06-scaling/06-circuit-breakers' },
                { text: 'Backpressure', link: '/06-scaling/07-backpressure' },
                { text: 'Auto-Scaling', link: '/06-scaling/08-auto-scaling' },
              ]
            },
            {
              text: '7. Real-Time',
              collapsed: true,
              items: [
                { text: 'Polling', link: '/07-real-time/01-polling' },
                { text: 'Long Polling', link: '/07-real-time/02-long-polling' },
                { text: 'Server-Sent Events', link: '/07-real-time/03-server-sent-events' },
                { text: 'WebSockets', link: '/07-real-time/04-websockets' },
                { text: 'WebRTC', link: '/07-real-time/05-webrtc' },
                { text: 'Presence', link: '/07-real-time/06-presence' },
              ]
            },
            {
              text: '8. Case Studies',
              collapsed: true,
              items: [
                { text: 'Twitter', link: '/08-case-studies/01-twitter' },
                { text: 'Instagram', link: '/08-case-studies/02-instagram' },
                { text: 'Uber', link: '/08-case-studies/03-uber' },
                { text: 'Netflix', link: '/08-case-studies/04-netflix' },
                { text: 'Slack', link: '/08-case-studies/05-slack' },
                { text: 'Stripe', link: '/08-case-studies/06-stripe' },
                { text: 'Dropbox', link: '/08-case-studies/07-dropbox' },
                { text: 'Discord', link: '/08-case-studies/08-discord' },
                { text: 'Google Maps', link: '/08-case-studies/09-google-maps' },
                { text: 'WhatsApp', link: '/08-case-studies/10-whatsapp' },
              ]
            },
            {
              text: '9. Whitepapers',
              collapsed: true,
              items: [
                { text: 'MapReduce', link: '/09-whitepapers/01-mapreduce' },
                { text: 'Dynamo', link: '/09-whitepapers/02-dynamo' },
                { text: 'Bigtable', link: '/09-whitepapers/03-bigtable' },
                { text: 'Spanner', link: '/09-whitepapers/04-spanner' },
                { text: 'TAO', link: '/09-whitepapers/05-tao' },
                { text: 'Kafka', link: '/09-whitepapers/06-kafka' },
                { text: 'Raft', link: '/09-whitepapers/07-raft' },
                { text: 'Chubby', link: '/09-whitepapers/08-chubby' },
                { text: 'Aurora', link: '/09-whitepapers/09-aurora' },
                { text: 'CockroachDB', link: '/09-whitepapers/10-cockroachdb' },
              ]
            },
            {
              text: '10. Security',
              collapsed: true,
              items: [
                { text: 'Authentication Fundamentals', link: '/10-security/01-authentication-fundamentals' },
                { text: 'OAuth2 & OpenID Connect', link: '/10-security/02-oauth2-openid-connect' },
                { text: 'JWT Tokens', link: '/10-security/03-jwt-tokens' },
                { text: 'API Security', link: '/10-security/04-api-security' },
                { text: 'Zero Trust Architecture', link: '/10-security/05-zero-trust-architecture' },
                { text: 'Encryption', link: '/10-security/06-encryption' },
              ]
            },
            {
              text: '11. Observability',
              collapsed: true,
              items: [
                { text: 'Distributed Tracing', link: '/11-observability/01-distributed-tracing' },
                { text: 'Metrics & Monitoring', link: '/11-observability/02-metrics-monitoring' },
                { text: 'Logging', link: '/11-observability/03-logging' },
                { text: 'Alerting', link: '/11-observability/04-alerting' },
              ]
            },
            {
              text: '12. Service Mesh',
              collapsed: true,
              items: [
                { text: 'Service Discovery', link: '/12-service-mesh/01-service-discovery' },
                { text: 'API Gateway', link: '/12-service-mesh/02-api-gateway' },
                { text: 'Sidecar Pattern', link: '/12-service-mesh/03-sidecar-pattern' },
              ]
            },
            {
              text: '13. Data Pipelines',
              collapsed: true,
              items: [
                { text: 'Batch Processing', link: '/13-data-pipelines/01-batch-processing' },
                { text: 'Stream Processing', link: '/13-data-pipelines/02-stream-processing' },
                { text: 'Lambda & Kappa Architecture', link: '/13-data-pipelines/03-lambda-kappa-architecture' },
              ]
            },
            {
              text: '14. Search Systems',
              collapsed: true,
              items: [
                { text: 'Inverted Indexes', link: '/14-search-systems/01-inverted-indexes' },
                { text: 'Full-Text Search', link: '/14-search-systems/02-full-text-search' },
              ]
            },
            {
              text: '15. Deployment',
              collapsed: true,
              items: [
                { text: 'Deployment Strategies', link: '/15-deployment/01-deployment-strategies' },
                { text: 'Feature Flags', link: '/15-deployment/02-feature-flags' },
              ]
            },
            {
              text: '16. LLM Systems',
              collapsed: true,
              items: [
                { text: 'Agent Fundamentals', link: '/16-llm-systems/01-agent-fundamentals' },
                { text: 'Orchestration Patterns', link: '/16-llm-systems/02-orchestration-patterns' },
                { text: 'Multi-Agent Systems', link: '/16-llm-systems/03-multi-agent-systems' },
                { text: 'RAG Patterns', link: '/16-llm-systems/04-rag-patterns' },
                { text: 'LLM Infrastructure', link: '/16-llm-systems/05-llm-infrastructure' },
              ]
            },
          ]

          // Japanese sidebar
          const sidebarJA = [
            {
              text: '1. 基礎',
              collapsed: false,
              items: [
                { text: 'ACIDトランザクション', link: '/ja/01-foundations/01-acid-transactions' },
                { text: '分離レベル', link: '/ja/01-foundations/02-isolation-levels' },
                { text: 'CAP定理', link: '/ja/01-foundations/03-cap-theorem' },
                { text: '整合性モデル', link: '/ja/01-foundations/04-consistency-models' },
                { text: '分散時刻', link: '/ja/01-foundations/05-distributed-time' },
                { text: '障害モード', link: '/ja/01-foundations/06-failure-modes' },
                { text: 'ネットワーク分断', link: '/ja/01-foundations/07-network-partitions' },
                { text: '冪等性', link: '/ja/01-foundations/08-idempotency' },
              ]
            },
            {
              text: '2. 分散データベース',
              collapsed: true,
              items: [
                { text: 'シングルリーダーレプリケーション', link: '/ja/02-distributed-databases/01-single-leader-replication' },
                { text: 'マルチリーダーレプリケーション', link: '/ja/02-distributed-databases/02-multi-leader-replication' },
                { text: 'リーダーレスレプリケーション', link: '/ja/02-distributed-databases/03-leaderless-replication' },
                { text: 'コンフリクト解決', link: '/ja/02-distributed-databases/04-conflict-resolution' },
                { text: 'パーティショニング戦略', link: '/ja/02-distributed-databases/05-partitioning-strategies' },
                { text: 'セカンダリインデックス', link: '/ja/02-distributed-databases/06-secondary-indexes' },
                { text: '分散トランザクション', link: '/ja/02-distributed-databases/07-distributed-transactions' },
                { text: 'コンセンサスアルゴリズム', link: '/ja/02-distributed-databases/08-consensus-algorithms' },
                { text: 'リーダー選出', link: '/ja/02-distributed-databases/09-leader-election' },
              ]
            },
            {
              text: '3. ストレージエンジン',
              collapsed: true,
              items: [
                { text: 'B木', link: '/ja/03-storage-engines/01-b-trees' },
                { text: 'LSM木', link: '/ja/03-storage-engines/02-lsm-trees' },
                { text: 'SSTableとコンパクション', link: '/ja/03-storage-engines/03-sstables-compaction' },
                { text: '先行書き込みログ', link: '/ja/03-storage-engines/04-write-ahead-logging' },
                { text: 'ブルームフィルタ', link: '/ja/03-storage-engines/05-bloom-filters' },
                { text: 'カラムストレージ', link: '/ja/03-storage-engines/06-column-storage' },
                { text: 'データエンコーディング', link: '/ja/03-storage-engines/07-data-encoding' },
              ]
            },
            {
              text: '4. キャッシング',
              collapsed: true,
              items: [
                { text: 'キャッシュ戦略', link: '/ja/04-caching/01-cache-strategies' },
                { text: 'キャッシュ無効化', link: '/ja/04-caching/02-cache-invalidation' },
                { text: '分散キャッシュ', link: '/ja/04-caching/03-distributed-caching' },
                { text: 'キャッシュスタンピード', link: '/ja/04-caching/04-cache-stampede' },
                { text: '多層キャッシュ', link: '/ja/04-caching/05-multi-tier-caching' },
                { text: 'キャッシュウォーミング', link: '/ja/04-caching/06-cache-warming' },
              ]
            },
            {
              text: '5. メッセージング',
              collapsed: true,
              items: [
                { text: 'メッセージキュー', link: '/ja/05-messaging/01-message-queues' },
                { text: 'Pub/Sub', link: '/ja/05-messaging/02-pub-sub' },
                { text: 'メッセージ順序', link: '/ja/05-messaging/03-message-ordering' },
                { text: '配信保証', link: '/ja/05-messaging/04-delivery-guarantees' },
                { text: 'イベントソーシング', link: '/ja/05-messaging/05-event-sourcing' },
                { text: 'CQRS', link: '/ja/05-messaging/06-cqrs' },
                { text: 'Outboxパターン', link: '/ja/05-messaging/07-outbox-pattern' },
                { text: 'デッドレターキュー', link: '/ja/05-messaging/08-dead-letter-queues' },
              ]
            },
            {
              text: '6. スケーリング',
              collapsed: true,
              items: [
                { text: 'ロードバランシング', link: '/ja/06-scaling/01-load-balancing' },
                { text: '水平 vs 垂直スケーリング', link: '/ja/06-scaling/02-horizontal-vertical' },
                { text: 'データベースシャーディング', link: '/ja/06-scaling/03-database-sharding' },
                { text: 'CDNアーキテクチャ', link: '/ja/06-scaling/04-cdn-architecture' },
                { text: 'レート制限', link: '/ja/06-scaling/05-rate-limiting' },
                { text: 'サーキットブレーカー', link: '/ja/06-scaling/06-circuit-breakers' },
                { text: 'バックプレッシャー', link: '/ja/06-scaling/07-backpressure' },
                { text: 'オートスケーリング', link: '/ja/06-scaling/08-auto-scaling' },
              ]
            },
            {
              text: '7. リアルタイム',
              collapsed: true,
              items: [
                { text: 'ポーリング', link: '/ja/07-real-time/01-polling' },
                { text: 'ロングポーリング', link: '/ja/07-real-time/02-long-polling' },
                { text: 'Server-Sent Events', link: '/ja/07-real-time/03-server-sent-events' },
                { text: 'WebSocket', link: '/ja/07-real-time/04-websockets' },
                { text: 'WebRTC', link: '/ja/07-real-time/05-webrtc' },
                { text: 'プレゼンス', link: '/ja/07-real-time/06-presence' },
              ]
            },
            {
              text: '8. ケーススタディ',
              collapsed: true,
              items: [
                { text: 'Twitter', link: '/ja/08-case-studies/01-twitter' },
                { text: 'Instagram', link: '/ja/08-case-studies/02-instagram' },
                { text: 'Uber', link: '/ja/08-case-studies/03-uber' },
                { text: 'Netflix', link: '/ja/08-case-studies/04-netflix' },
                { text: 'Slack', link: '/ja/08-case-studies/05-slack' },
                { text: 'Stripe', link: '/ja/08-case-studies/06-stripe' },
                { text: 'Dropbox', link: '/ja/08-case-studies/07-dropbox' },
                { text: 'Discord', link: '/ja/08-case-studies/08-discord' },
                { text: 'Google Maps', link: '/ja/08-case-studies/09-google-maps' },
                { text: 'WhatsApp', link: '/ja/08-case-studies/10-whatsapp' },
              ]
            },
            {
              text: '9. 論文',
              collapsed: true,
              items: [
                { text: 'MapReduce', link: '/ja/09-whitepapers/01-mapreduce' },
                { text: 'Dynamo', link: '/ja/09-whitepapers/02-dynamo' },
                { text: 'Bigtable', link: '/ja/09-whitepapers/03-bigtable' },
                { text: 'Spanner', link: '/ja/09-whitepapers/04-spanner' },
                { text: 'TAO', link: '/ja/09-whitepapers/05-tao' },
                { text: 'Kafka', link: '/ja/09-whitepapers/06-kafka' },
                { text: 'Raft', link: '/ja/09-whitepapers/07-raft' },
                { text: 'Chubby', link: '/ja/09-whitepapers/08-chubby' },
                { text: 'Aurora', link: '/ja/09-whitepapers/09-aurora' },
                { text: 'CockroachDB', link: '/ja/09-whitepapers/10-cockroachdb' },
              ]
            },
            {
              text: '10. セキュリティ',
              collapsed: true,
              items: [
                { text: '認証の基礎', link: '/ja/10-security/01-authentication-fundamentals' },
                { text: 'OAuth2 & OpenID Connect', link: '/ja/10-security/02-oauth2-openid-connect' },
                { text: 'JWTトークン', link: '/ja/10-security/03-jwt-tokens' },
                { text: 'APIセキュリティ', link: '/ja/10-security/04-api-security' },
                { text: 'ゼロトラストアーキテクチャ', link: '/ja/10-security/05-zero-trust-architecture' },
                { text: '暗号化', link: '/ja/10-security/06-encryption' },
              ]
            },
            {
              text: '11. オブザーバビリティ',
              collapsed: true,
              items: [
                { text: '分散トレーシング', link: '/ja/11-observability/01-distributed-tracing' },
                { text: 'メトリクスと監視', link: '/ja/11-observability/02-metrics-monitoring' },
                { text: 'ログ', link: '/ja/11-observability/03-logging' },
                { text: 'アラート', link: '/ja/11-observability/04-alerting' },
              ]
            },
            {
              text: '12. サービスメッシュ',
              collapsed: true,
              items: [
                { text: 'サービスディスカバリ', link: '/ja/12-service-mesh/01-service-discovery' },
                { text: 'APIゲートウェイ', link: '/ja/12-service-mesh/02-api-gateway' },
                { text: 'サイドカーパターン', link: '/ja/12-service-mesh/03-sidecar-pattern' },
              ]
            },
            {
              text: '13. データパイプライン',
              collapsed: true,
              items: [
                { text: 'バッチ処理', link: '/ja/13-data-pipelines/01-batch-processing' },
                { text: 'ストリーム処理', link: '/ja/13-data-pipelines/02-stream-processing' },
                { text: 'Lambda & Kappaアーキテクチャ', link: '/ja/13-data-pipelines/03-lambda-kappa-architecture' },
              ]
            },
            {
              text: '14. 検索システム',
              collapsed: true,
              items: [
                { text: '転置インデックス', link: '/ja/14-search-systems/01-inverted-indexes' },
                { text: '全文検索', link: '/ja/14-search-systems/02-full-text-search' },
              ]
            },
            {
              text: '15. デプロイメント',
              collapsed: true,
              items: [
                { text: 'デプロイ戦略', link: '/ja/15-deployment/01-deployment-strategies' },
                { text: 'フィーチャーフラグ', link: '/ja/15-deployment/02-feature-flags' },
              ]
            },
            {
              text: '16. LLMシステム',
              collapsed: true,
              items: [
                { text: 'エージェントの基礎', link: '/ja/16-llm-systems/01-agent-fundamentals' },
                { text: 'オーケストレーションパターン', link: '/ja/16-llm-systems/02-orchestration-patterns' },
                { text: 'マルチエージェントシステム', link: '/ja/16-llm-systems/03-multi-agent-systems' },
                { text: 'RAGパターン', link: '/ja/16-llm-systems/04-rag-patterns' },
                { text: 'LLMインフラストラクチャ', link: '/ja/16-llm-systems/05-llm-infrastructure' },
              ]
            },
          ]

          export default defineConfig({
            title: 'Babushkai System Design Patterns',
            description: 'A comprehensive guide to distributed systems and system design patterns',
            
            // Base URL for GitHub Pages (repo name)
            base: '/system-design-patterns/',
            
            // Ignore dead links in README.md (original repo content)
            ignoreDeadLinks: true,
            
            head: [
              ['link', { rel: 'icon', type: 'image/svg+xml', href: '/logo.svg' }],
              ['meta', { name: 'theme-color', content: '#E91E63' }],
              ['meta', { property: 'og:type', content: 'website' }],
              ['meta', { property: 'og:title', content: 'Babushkai System Design Patterns' }],
              ['meta', { property: 'og:description', content: 'A comprehensive guide to distributed systems' }],
            ],

            locales: {
              root: {
                label: 'English',
                lang: 'en',
                themeConfig: {
                  nav: [
                    { text: 'Home', link: '/' },
                    { text: 'Guide', link: '/01-foundations/01-acid-transactions' },
                    { 
                      text: 'Sections',
                      items: [
                        { text: 'Foundations', link: '/01-foundations/01-acid-transactions' },
                        { text: 'Distributed Databases', link: '/02-distributed-databases/01-single-leader-replication' },
                        { text: 'Storage Engines', link: '/03-storage-engines/01-b-trees' },
                        { text: 'Caching', link: '/04-caching/01-cache-strategies' },
                        { text: 'Messaging', link: '/05-messaging/01-message-queues' },
                        { text: 'Scaling', link: '/06-scaling/01-load-balancing' },
                        { text: 'Real-Time', link: '/07-real-time/01-polling' },
                        { text: 'Case Studies', link: '/08-case-studies/01-twitter' },
                        { text: 'Whitepapers', link: '/09-whitepapers/01-mapreduce' },
                        { text: 'Security', link: '/10-security/01-authentication-fundamentals' },
                        { text: 'Observability', link: '/11-observability/01-distributed-tracing' },
                        { text: 'Service Mesh', link: '/12-service-mesh/01-service-discovery' },
                        { text: 'Data Pipelines', link: '/13-data-pipelines/01-batch-processing' },
                        { text: 'Search Systems', link: '/14-search-systems/01-inverted-indexes' },
                        { text: 'Deployment', link: '/15-deployment/01-deployment-strategies' },
                        { text: 'LLM Systems', link: '/16-llm-systems/01-agent-fundamentals' },
                      ]
                    },
                    { text: 'GitHub', link: 'https://github.com/babushkai/system-design-patterns' }
                  ],
                  sidebar: { '/': sidebarEN },
                  editLink: {
                    pattern: 'https://github.com/babushkai/system-design-patterns/edit/main/:path',
                    text: 'Edit this page on GitHub'
                  },
                  footer: {
                    message: 'Released under the MIT License.',
                    copyright: 'Copyright 2024-present Babushkai'
                  },
                }
              },
              ja: {
                label: '日本語',
                lang: 'ja',
                link: '/ja/',
                themeConfig: {
                  nav: [
                    { text: 'ホーム', link: '/ja/' },
                    { text: 'ガイド', link: '/ja/01-foundations/01-acid-transactions' },
                    { 
                      text: 'セクション',
                      items: [
                        { text: '基礎', link: '/ja/01-foundations/01-acid-transactions' },
                        { text: '分散データベース', link: '/ja/02-distributed-databases/01-single-leader-replication' },
                        { text: 'ストレージエンジン', link: '/ja/03-storage-engines/01-b-trees' },
                        { text: 'キャッシング', link: '/ja/04-caching/01-cache-strategies' },
                        { text: 'メッセージング', link: '/ja/05-messaging/01-message-queues' },
                        { text: 'スケーリング', link: '/ja/06-scaling/01-load-balancing' },
                        { text: 'リアルタイム', link: '/ja/07-real-time/01-polling' },
                        { text: 'ケーススタディ', link: '/ja/08-case-studies/01-twitter' },
                        { text: '論文', link: '/ja/09-whitepapers/01-mapreduce' },
                        { text: 'セキュリティ', link: '/ja/10-security/01-authentication-fundamentals' },
                        { text: 'オブザーバビリティ', link: '/ja/11-observability/01-distributed-tracing' },
                        { text: 'サービスメッシュ', link: '/ja/12-service-mesh/01-service-discovery' },
                        { text: 'データパイプライン', link: '/ja/13-data-pipelines/01-batch-processing' },
                        { text: '検索システム', link: '/ja/14-search-systems/01-inverted-indexes' },
                        { text: 'デプロイメント', link: '/ja/15-deployment/01-deployment-strategies' },
                        { text: 'LLMシステム', link: '/ja/16-llm-systems/01-agent-fundamentals' },
                      ]
                    },
                    { text: 'GitHub', link: 'https://github.com/babushkai/system-design-patterns' }
                  ],
                  sidebar: { '/ja/': sidebarJA },
                  editLink: {
                    pattern: 'https://github.com/babushkai/system-design-patterns/edit/main/:path',
                    text: 'GitHubでこのページを編集'
                  },
                  footer: {
                    message: 'MITライセンスの下で公開',
                    copyright: 'Copyright 2024-present Babushkai'
                  },
                  outline: {
                    label: '目次'
                  },
                  docFooter: {
                    prev: '前のページ',
                    next: '次のページ'
                  },
                  darkModeSwitchLabel: 'テーマ',
                  sidebarMenuLabel: 'メニュー',
                  returnToTopLabel: 'トップに戻る',
                }
              }
            },

            themeConfig: {
              logo: '/logo.svg',
              siteTitle: 'Babushkai System Design Patterns',
              
              socialLinks: [
                { icon: 'github', link: 'https://github.com/babushkai/system-design-patterns' }
              ],

              search: {
                provider: 'local'
              },

              outline: {
                level: [2, 3],
                label: 'On this page'
              }
            },

            markdown: {
              lineNumbers: true,
              theme: {
                light: 'github-light',
                dark: 'github-dark'
              }
            },

            lastUpdated: true,
            cleanUrls: true,
          })
          VITECONFIG

          # Generate English homepage
          cat > index.md << 'HOMEPAGE'
          ---
          layout: home

          hero:
            name: "Babushk<span class='ai-accent'>a<span class='doll-i'>i</span></span>"
            text: "System Design Patterns"
            tagline: A comprehensive guide to distributed systems - from fundamentals to production-ready patterns
            image:
              src: /logo.svg
              alt: Babushkai
            actions:
              - theme: brand
                text: Get Started
                link: /01-foundations/01-acid-transactions
              - theme: alt
                text: View on GitHub
                link: https://github.com/babushkai/system-design-patterns

          features:
            - icon:
                src: /icons/foundations.svg
              title: Foundations
              details: Master ACID transactions, CAP theorem, consistency models, and distributed time
              link: /01-foundations/01-acid-transactions
            - icon:
                src: /icons/database.svg
              title: Distributed Databases
              details: Learn replication, partitioning, consensus algorithms, and distributed transactions
              link: /02-distributed-databases/01-single-leader-replication
            - icon:
                src: /icons/caching.svg
              title: Caching & Performance
              details: Cache strategies, invalidation patterns, and multi-tier caching architectures
              link: /04-caching/01-cache-strategies
            - icon:
                src: /icons/messaging.svg
              title: Messaging Systems
              details: Message queues, event sourcing, CQRS, and exactly-once delivery semantics
              link: /05-messaging/01-message-queues
            - icon:
                src: /icons/scaling.svg
              title: Scaling Patterns
              details: Load balancing, sharding, rate limiting, circuit breakers, and backpressure
              link: /06-scaling/01-load-balancing
            - icon:
                src: /icons/casestudies.svg
              title: Case Studies
              details: Learn from Twitter, Netflix, Uber, Stripe, Discord, and other tech giants
              link: /08-case-studies/01-twitter
            - icon:
                src: /icons/whitepapers.svg
              title: Academic Whitepapers
              details: Deep dives into MapReduce, Dynamo, Spanner, Kafka, Raft, and more
              link: /09-whitepapers/01-mapreduce
            - icon:
                src: /icons/llm.svg
              title: LLM Systems
              details: Agent architectures, orchestration patterns, RAG, and multi-agent systems
              link: /16-llm-systems/01-agent-fundamentals
          ---

          <div class="two-column-section">
            <div class="navigation-column">
              <h2>Quick Navigation</h2>
              <div class="nav-grid">
                <a href="/01-foundations/01-acid-transactions" class="nav-item">
                  <span class="nav-num">01</span>
                  <span class="nav-title">Foundations</span>
                </a>
                <a href="/02-distributed-databases/01-single-leader-replication" class="nav-item">
                  <span class="nav-num">02</span>
                  <span class="nav-title">Distributed Databases</span>
                </a>
                <a href="/03-storage-engines/01-b-trees" class="nav-item">
                  <span class="nav-num">03</span>
                  <span class="nav-title">Storage Engines</span>
                </a>
                <a href="/04-caching/01-cache-strategies" class="nav-item">
                  <span class="nav-num">04</span>
                  <span class="nav-title">Caching</span>
                </a>
                <a href="/05-messaging/01-message-queues" class="nav-item">
                  <span class="nav-num">05</span>
                  <span class="nav-title">Messaging</span>
                </a>
                <a href="/06-scaling/01-load-balancing" class="nav-item">
                  <span class="nav-num">06</span>
                  <span class="nav-title">Scaling</span>
                </a>
                <a href="/07-real-time/01-polling" class="nav-item">
                  <span class="nav-num">07</span>
                  <span class="nav-title">Real-Time</span>
                </a>
                <a href="/08-case-studies/01-twitter" class="nav-item">
                  <span class="nav-num">08</span>
                  <span class="nav-title">Case Studies</span>
                </a>
                <a href="/09-whitepapers/01-mapreduce" class="nav-item">
                  <span class="nav-num">09</span>
                  <span class="nav-title">Whitepapers</span>
                </a>
                <a href="/10-security/01-authentication-fundamentals" class="nav-item">
                  <span class="nav-num">10</span>
                  <span class="nav-title">Security</span>
                </a>
                <a href="/11-observability/01-distributed-tracing" class="nav-item">
                  <span class="nav-num">11</span>
                  <span class="nav-title">Observability</span>
                </a>
                <a href="/12-service-mesh/01-service-discovery" class="nav-item">
                  <span class="nav-num">12</span>
                  <span class="nav-title">Service Mesh</span>
                </a>
                <a href="/13-data-pipelines/01-batch-processing" class="nav-item">
                  <span class="nav-num">13</span>
                  <span class="nav-title">Data Pipelines</span>
                </a>
                <a href="/14-search-systems/01-inverted-indexes" class="nav-item">
                  <span class="nav-num">14</span>
                  <span class="nav-title">Search Systems</span>
                </a>
                <a href="/15-deployment/01-deployment-strategies" class="nav-item">
                  <span class="nav-num">15</span>
                  <span class="nav-title">Deployment</span>
                </a>
                <a href="/16-llm-systems/01-agent-fundamentals" class="nav-item">
                  <span class="nav-num">16</span>
                  <span class="nav-title">LLM Systems</span>
                </a>
              </div>
            </div>
            <div class="about-column">
              <h2>About Babushkai</h2>
              <p>Like the layers of a Matryoshka doll, great systems are built layer by layer - each component nesting perfectly within the next.</p>
              <p>This guide covers <strong>80+ patterns</strong> across distributed systems, from foundational concepts to production-ready architectures used by companies like Netflix, Uber, and Stripe.</p>
              <div class="stats">
                <div class="stat">
                  <span class="stat-num">16</span>
                  <span class="stat-label">Sections</span>
                </div>
                <div class="stat">
                  <span class="stat-num">80+</span>
                  <span class="stat-label">Patterns</span>
                </div>
                <div class="stat">
                  <span class="stat-num">10</span>
                  <span class="stat-label">Case Studies</span>
                </div>
              </div>
            </div>
          </div>

          <style>
          .two-column-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            padding: 2rem 0;
            margin: 2rem 0;
            border-top: 1px solid var(--vp-c-divider);
          }
          @media (max-width: 768px) {
            .two-column-section {
              grid-template-columns: 1fr;
            }
          }
          .navigation-column h2, .about-column h2 {
            margin-bottom: 1.5rem;
            color: var(--vp-c-brand-1);
          }
          .nav-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
          }
          .nav-item {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            border-radius: 6px;
            text-decoration: none;
            color: var(--vp-c-text-1);
            transition: background 0.2s;
          }
          .nav-item:hover {
            background: var(--vp-c-brand-soft);
          }
          .nav-num {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--vp-c-brand-1);
            margin-right: 0.5rem;
            min-width: 1.5rem;
          }
          .nav-title {
            font-size: 0.875rem;
          }
          .about-column p {
            margin-bottom: 1rem;
            line-height: 1.7;
          }
          .stats {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
          }
          .stat {
            text-align: center;
          }
          .stat-num {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            color: var(--vp-c-brand-1);
          }
          .stat-label {
            font-size: 0.875rem;
            color: var(--vp-c-text-2);
          }
          </style>
          HOMEPAGE

          # Generate Japanese homepage
          mkdir -p ja
          cat > ja/index.md << 'HOMEPAGE_JA'
          ---
          layout: home

          hero:
            name: "Babushk<span class='ai-accent'>a<span class='doll-i'>i</span></span>"
            text: "システム設計パターン"
            tagline: 分散システムの総合ガイド - 基礎から本番運用パターンまで
            image:
              src: /logo.svg
              alt: Babushkai
            actions:
              - theme: brand
                text: はじめる
                link: /ja/01-foundations/01-acid-transactions
              - theme: alt
                text: GitHubで見る
                link: https://github.com/babushkai/system-design-patterns

          features:
            - icon:
                src: /icons/foundations.svg
              title: 基礎
              details: ACIDトランザクション、CAP定理、整合性モデル、分散時刻をマスター
              link: /ja/01-foundations/01-acid-transactions
            - icon:
                src: /icons/database.svg
              title: 分散データベース
              details: レプリケーション、パーティショニング、コンセンサスアルゴリズム、分散トランザクション
              link: /ja/02-distributed-databases/01-single-leader-replication
            - icon:
                src: /icons/caching.svg
              title: キャッシング & パフォーマンス
              details: キャッシュ戦略、無効化パターン、多層キャッシュアーキテクチャ
              link: /ja/04-caching/01-cache-strategies
            - icon:
                src: /icons/messaging.svg
              title: メッセージングシステム
              details: メッセージキュー、イベントソーシング、CQRS、exactly-once配信
              link: /ja/05-messaging/01-message-queues
            - icon:
                src: /icons/scaling.svg
              title: スケーリングパターン
              details: ロードバランシング、シャーディング、レート制限、サーキットブレーカー
              link: /ja/06-scaling/01-load-balancing
            - icon:
                src: /icons/casestudies.svg
              title: ケーススタディ
              details: Twitter、Netflix、Uber、Stripe、Discordなどの大手企業から学ぶ
              link: /ja/08-case-studies/01-twitter
            - icon:
                src: /icons/whitepapers.svg
              title: 学術論文
              details: MapReduce、Dynamo、Spanner、Kafka、Raftなどを深掘り
              link: /ja/09-whitepapers/01-mapreduce
            - icon:
                src: /icons/llm.svg
              title: LLMシステム
              details: エージェントアーキテクチャ、オーケストレーション、RAG、マルチエージェント
              link: /ja/16-llm-systems/01-agent-fundamentals
          ---

          <div class="two-column-section">
            <div class="navigation-column">
              <h2>クイックナビゲーション</h2>
              <div class="nav-grid">
                <a href="/ja/01-foundations/01-acid-transactions" class="nav-item">
                  <span class="nav-num">01</span>
                  <span class="nav-title">基礎</span>
                </a>
                <a href="/ja/02-distributed-databases/01-single-leader-replication" class="nav-item">
                  <span class="nav-num">02</span>
                  <span class="nav-title">分散データベース</span>
                </a>
                <a href="/ja/03-storage-engines/01-b-trees" class="nav-item">
                  <span class="nav-num">03</span>
                  <span class="nav-title">ストレージエンジン</span>
                </a>
                <a href="/ja/04-caching/01-cache-strategies" class="nav-item">
                  <span class="nav-num">04</span>
                  <span class="nav-title">キャッシング</span>
                </a>
                <a href="/ja/05-messaging/01-message-queues" class="nav-item">
                  <span class="nav-num">05</span>
                  <span class="nav-title">メッセージング</span>
                </a>
                <a href="/ja/06-scaling/01-load-balancing" class="nav-item">
                  <span class="nav-num">06</span>
                  <span class="nav-title">スケーリング</span>
                </a>
                <a href="/ja/07-real-time/01-polling" class="nav-item">
                  <span class="nav-num">07</span>
                  <span class="nav-title">リアルタイム</span>
                </a>
                <a href="/ja/08-case-studies/01-twitter" class="nav-item">
                  <span class="nav-num">08</span>
                  <span class="nav-title">ケーススタディ</span>
                </a>
                <a href="/ja/09-whitepapers/01-mapreduce" class="nav-item">
                  <span class="nav-num">09</span>
                  <span class="nav-title">論文</span>
                </a>
                <a href="/ja/10-security/01-authentication-fundamentals" class="nav-item">
                  <span class="nav-num">10</span>
                  <span class="nav-title">セキュリティ</span>
                </a>
                <a href="/ja/11-observability/01-distributed-tracing" class="nav-item">
                  <span class="nav-num">11</span>
                  <span class="nav-title">オブザーバビリティ</span>
                </a>
                <a href="/ja/12-service-mesh/01-service-discovery" class="nav-item">
                  <span class="nav-num">12</span>
                  <span class="nav-title">サービスメッシュ</span>
                </a>
                <a href="/ja/13-data-pipelines/01-batch-processing" class="nav-item">
                  <span class="nav-num">13</span>
                  <span class="nav-title">データパイプライン</span>
                </a>
                <a href="/ja/14-search-systems/01-inverted-indexes" class="nav-item">
                  <span class="nav-num">14</span>
                  <span class="nav-title">検索システム</span>
                </a>
                <a href="/ja/15-deployment/01-deployment-strategies" class="nav-item">
                  <span class="nav-num">15</span>
                  <span class="nav-title">デプロイメント</span>
                </a>
                <a href="/ja/16-llm-systems/01-agent-fundamentals" class="nav-item">
                  <span class="nav-num">16</span>
                  <span class="nav-title">LLMシステム</span>
                </a>
              </div>
            </div>
            <div class="about-column">
              <h2>Babushkaiについて</h2>
              <p>マトリョーシカ人形の層のように、優れたシステムは層を重ねて構築されます。各コンポーネントが次の層に完璧に収まるように。</p>
              <p>このガイドでは、Netflix、Uber、Stripeなどの企業で使用されている<strong>80以上のパターン</strong>を、基礎概念から本番運用アーキテクチャまでカバーしています。</p>
              <div class="stats">
                <div class="stat">
                  <span class="stat-num">16</span>
                  <span class="stat-label">セクション</span>
                </div>
                <div class="stat">
                  <span class="stat-num">80+</span>
                  <span class="stat-label">パターン</span>
                </div>
                <div class="stat">
                  <span class="stat-num">10</span>
                  <span class="stat-label">ケーススタディ</span>
                </div>
              </div>
            </div>
          </div>

          <style>
          .two-column-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            padding: 2rem 0;
            margin: 2rem 0;
            border-top: 1px solid var(--vp-c-divider);
          }
          @media (max-width: 768px) {
            .two-column-section {
              grid-template-columns: 1fr;
            }
          }
          .navigation-column h2, .about-column h2 {
            margin-bottom: 1.5rem;
            color: var(--vp-c-brand-1);
          }
          .nav-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
          }
          .nav-item {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            border-radius: 6px;
            text-decoration: none;
            color: var(--vp-c-text-1);
            transition: background 0.2s;
          }
          .nav-item:hover {
            background: var(--vp-c-brand-soft);
          }
          .nav-num {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--vp-c-brand-1);
            margin-right: 0.5rem;
            min-width: 1.5rem;
          }
          .nav-title {
            font-size: 0.875rem;
          }
          .about-column p {
            margin-bottom: 1rem;
            line-height: 1.7;
          }
          .stats {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
          }
          .stat {
            text-align: center;
          }
          .stat-num {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            color: var(--vp-c-brand-1);
          }
          .stat-label {
            font-size: 0.875rem;
            color: var(--vp-c-text-2);
          }
          </style>
          HOMEPAGE_JA

          # Generate Matryoshka doll logo SVG
          cat > public/logo.svg << 'LOGO'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
            <!-- Outer doll body -->
            <ellipse cx="50" cy="62" rx="35" ry="38" fill="#E91E63"/>
            <!-- Outer doll head -->
            <circle cx="50" cy="28" r="22" fill="#FFCCBC"/>
            <!-- Hair/headscarf -->
            <path d="M28 28 Q50 5 72 28 Q72 15 50 10 Q28 15 28 28" fill="#E91E63"/>
            <!-- Face circle -->
            <circle cx="50" cy="32" r="15" fill="#FFCCBC"/>
            <!-- Eyes -->
            <circle cx="44" cy="30" r="2" fill="#333"/>
            <circle cx="56" cy="30" r="2" fill="#333"/>
            <!-- Smile -->
            <path d="M44 36 Q50 40 56 36" stroke="#333" stroke-width="1.5" fill="none"/>
            <!-- Blush -->
            <circle cx="40" cy="35" r="3" fill="#FFAB91" opacity="0.6"/>
            <circle cx="60" cy="35" r="3" fill="#FFAB91" opacity="0.6"/>
            <!-- Middle doll (nested) -->
            <ellipse cx="50" cy="70" rx="20" ry="22" fill="#FF4081"/>
            <!-- Inner doll (nested) -->
            <ellipse cx="50" cy="75" rx="12" ry="14" fill="#F8BBD9"/>
            <!-- Decorative pattern -->
            <circle cx="50" cy="68" r="6" fill="#FCE4EC"/>
            <circle cx="50" cy="68" r="3" fill="#E91E63"/>
          </svg>
          LOGO

          # Generate feature icons
          mkdir -p public/icons

          cat > public/icons/foundations.svg << 'ICON_FOUNDATIONS'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <rect x="6" y="32" width="36" height="8" rx="2" fill="#E91E63"/>
            <rect x="10" y="22" width="28" height="8" rx="2" fill="#FF4081"/>
            <rect x="14" y="12" width="20" height="8" rx="2" fill="#F8BBD9"/>
            <polygon points="24,4 34,12 14,12" fill="#E91E63"/>
          </svg>
          ICON_FOUNDATIONS

          cat > public/icons/database.svg << 'ICON_DATABASE'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <ellipse cx="24" cy="12" rx="16" ry="6" fill="#E91E63"/>
            <path d="M8 12v8c0 3.3 7.2 6 16 6s16-2.7 16-6v-8" stroke="#E91E63" stroke-width="3" fill="none"/>
            <ellipse cx="24" cy="20" rx="16" ry="6" fill="none" stroke="#FF4081" stroke-width="2"/>
            <path d="M8 20v8c0 3.3 7.2 6 16 6s16-2.7 16-6v-8" stroke="#E91E63" stroke-width="3" fill="none"/>
            <ellipse cx="24" cy="28" rx="16" ry="6" fill="none" stroke="#FF4081" stroke-width="2"/>
            <path d="M8 28v8c0 3.3 7.2 6 16 6s16-2.7 16-6v-8" stroke="#E91E63" stroke-width="3" fill="none"/>
            <ellipse cx="24" cy="36" rx="16" ry="6" fill="#F8BBD9"/>
          </svg>
          ICON_DATABASE

          cat > public/icons/caching.svg << 'ICON_CACHING'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <circle cx="24" cy="24" r="18" stroke="#E91E63" stroke-width="3" fill="none"/>
            <circle cx="24" cy="24" r="12" stroke="#FF4081" stroke-width="2" fill="none"/>
            <circle cx="24" cy="24" r="6" fill="#E91E63"/>
            <path d="M24 6v4M24 38v4M6 24h4M38 24h4" stroke="#E91E63" stroke-width="2" stroke-linecap="round"/>
            <path d="M11 11l3 3M34 34l3 3M11 37l3-3M34 14l3-3" stroke="#FF4081" stroke-width="2" stroke-linecap="round"/>
          </svg>
          ICON_CACHING

          cat > public/icons/messaging.svg << 'ICON_MESSAGING'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <rect x="4" y="8" width="20" height="14" rx="3" fill="#E91E63"/>
            <polygon points="8,22 12,28 16,22" fill="#E91E63"/>
            <rect x="24" y="18" width="20" height="14" rx="3" fill="#FF4081"/>
            <polygon points="28,32 32,38 36,32" fill="#FF4081"/>
            <path d="M14 14h6M14 18h4" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
            <path d="M34 24h6M34 28h4" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
            <circle cx="38" cy="12" r="6" fill="#F8BBD9" stroke="#E91E63" stroke-width="2"/>
            <path d="M36 12h4M38 10v4" stroke="#E91E63" stroke-width="2" stroke-linecap="round"/>
          </svg>
          ICON_MESSAGING

          cat > public/icons/scaling.svg << 'ICON_SCALING'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <rect x="4" y="28" width="8" height="16" rx="2" fill="#F8BBD9"/>
            <rect x="14" y="20" width="8" height="24" rx="2" fill="#FF4081"/>
            <rect x="24" y="12" width="8" height="32" rx="2" fill="#E91E63"/>
            <rect x="34" y="4" width="8" height="40" rx="2" fill="#C2185B"/>
            <path d="M6 26l8-8 8 8 8-8 8-8" stroke="#E91E63" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="6" cy="26" r="2" fill="#E91E63"/>
            <circle cx="14" cy="18" r="2" fill="#E91E63"/>
            <circle cx="22" cy="26" r="2" fill="#E91E63"/>
            <circle cx="30" cy="18" r="2" fill="#E91E63"/>
            <circle cx="38" cy="10" r="2" fill="#E91E63"/>
          </svg>
          ICON_SCALING

          cat > public/icons/casestudies.svg << 'ICON_CASESTUDIES'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <rect x="6" y="6" width="36" height="36" rx="4" fill="none" stroke="#E91E63" stroke-width="3"/>
            <rect x="10" y="10" width="12" height="12" rx="2" fill="#E91E63"/>
            <rect x="26" y="10" width="12" height="12" rx="2" fill="#FF4081"/>
            <rect x="10" y="26" width="12" height="12" rx="2" fill="#FF4081"/>
            <rect x="26" y="26" width="12" height="12" rx="2" fill="#F8BBD9"/>
            <circle cx="16" cy="16" r="3" fill="#fff"/>
            <circle cx="32" cy="16" r="3" fill="#fff"/>
            <circle cx="16" cy="32" r="3" fill="#fff"/>
            <circle cx="32" cy="32" r="3" fill="#fff"/>
          </svg>
          ICON_CASESTUDIES

          cat > public/icons/whitepapers.svg << 'ICON_WHITEPAPERS'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <path d="M12 4h18l10 10v30a2 2 0 01-2 2H12a2 2 0 01-2-2V6a2 2 0 012-2z" fill="#F8BBD9" stroke="#E91E63" stroke-width="2"/>
            <path d="M30 4v10h10" fill="#E91E63"/>
            <path d="M30 4l10 10" stroke="#E91E63" stroke-width="2"/>
            <path d="M16 20h16M16 26h16M16 32h12" stroke="#E91E63" stroke-width="2" stroke-linecap="round"/>
            <circle cx="36" cy="36" r="8" fill="#E91E63"/>
            <path d="M33 36h6M36 33v6" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
          </svg>
          ICON_WHITEPAPERS

          cat > public/icons/llm.svg << 'ICON_LLM'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="none">
            <circle cx="24" cy="24" r="18" fill="none" stroke="#E91E63" stroke-width="3"/>
            <circle cx="24" cy="24" r="10" fill="#F8BBD9"/>
            <circle cx="24" cy="24" r="4" fill="#E91E63"/>
            <circle cx="24" cy="8" r="4" fill="#FF4081"/>
            <circle cx="24" cy="40" r="4" fill="#FF4081"/>
            <circle cx="10" cy="16" r="3" fill="#FF4081"/>
            <circle cx="38" cy="16" r="3" fill="#FF4081"/>
            <circle cx="10" cy="32" r="3" fill="#FF4081"/>
            <circle cx="38" cy="32" r="3" fill="#FF4081"/>
            <path d="M24 14v-2M24 36v2M14 18l-2-1M34 18l2-1M14 30l-2 1M34 30l2 1" stroke="#E91E63" stroke-width="2" stroke-linecap="round"/>
          </svg>
          ICON_LLM

          # Generate custom theme CSS to match logo colors
          mkdir -p .vitepress/theme
          cat > .vitepress/theme/index.ts << 'THEME'
          import DefaultTheme from 'vitepress/theme'
          import './custom.css'

          export default DefaultTheme
          THEME

          cat > .vitepress/theme/custom.css << 'CUSTOMCSS'
          /* Pink theme to match Matryoshka logo */
          :root {
            --vp-c-brand-1: #E91E63;
            --vp-c-brand-2: #D81B60;
            --vp-c-brand-3: #C2185B;
            --vp-c-brand-soft: rgba(233, 30, 99, 0.14);
            
            /* Hero gradient */
            --vp-home-hero-name-color: transparent;
            --vp-home-hero-name-background: linear-gradient(135deg, #E91E63 0%, #FF4081 100%);
            
            /* Button colors */
            --vp-button-brand-border: #E91E63;
            --vp-button-brand-text: #fff;
            --vp-button-brand-bg: #E91E63;
            --vp-button-brand-hover-border: #D81B60;
            --vp-button-brand-hover-text: #fff;
            --vp-button-brand-hover-bg: #D81B60;
            --vp-button-brand-active-border: #C2185B;
            --vp-button-brand-active-text: #fff;
            --vp-button-brand-active-bg: #C2185B;
          }

          .dark {
            --vp-c-brand-1: #FF4081;
            --vp-c-brand-2: #E91E63;
            --vp-c-brand-3: #F8BBD9;
            --vp-c-brand-soft: rgba(255, 64, 129, 0.16);
            
            --vp-button-brand-border: #FF4081;
            --vp-button-brand-text: #fff;
            --vp-button-brand-bg: #FF4081;
            --vp-button-brand-hover-border: #E91E63;
            --vp-button-brand-hover-text: #fff;
            --vp-button-brand-hover-bg: #E91E63;
          }

          /* Babushkai section styling */
          .babushkai-section {
            text-align: center;
            padding: 2rem 0;
            margin: 2rem 0;
            border-top: 1px solid var(--vp-c-divider);
          }

          .babushkai-section strong {
            color: var(--vp-c-brand-1);
          }

          /* AI accent styling in Babushkai - "i" as Matryoshka doll */
          .ai-accent {
            color: #FF4081;
            font-weight: inherit;
            font-style: italic;
          }

          .doll-i {
            display: inline-block;
            position: relative;
            font-style: normal;
            color: transparent;
            width: 0.5em;
          }

          .doll-i::before {
            content: '';
            position: absolute;
            top: 0.15em;
            left: 50%;
            transform: translateX(-50%);
            width: 0.35em;
            height: 0.35em;
            background: #FFCCBC;
            border-radius: 50%;
            border: 2px solid #E91E63;
          }

          .doll-i::after {
            content: '';
            position: absolute;
            top: 0.5em;
            left: 50%;
            transform: translateX(-50%);
            width: 0.45em;
            height: 0.6em;
            background: #E91E63;
            border-radius: 50% 50% 45% 45%;
          }
          CUSTOMCSS

          echo "VitePress configuration generated successfully!"

      - name: Install dependencies
        run: npm install

      - name: Build documentation
        run: npm run docs:build

      - name: Setup Pages
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        uses: actions/configure-pages@v4

      - name: Upload artifact
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        uses: actions/upload-pages-artifact@v3
        with:
          path: .vitepress/dist

  deploy:
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
